<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="icon.png" />
    <link rel="stylesheet" href="style.css" />
    <title>Dropchess</title>
  </head>

  <body x-data="new App()" @keydown.escape="selectPiece()">
    <div class="board">
      <template x-for="square in getSquares()">
        <div
          class="tile"
          :data-x="square.tile.x"
          :data-y="square.tile.y"
          :data-color="square.color"
          :data-selected="square.selected"
          :data-move="square.move?.type"
          :data-drop-state="square.tile.dropState"
          :data-piece="square.piece?.type"
          @click="square.move ? play(square.move) : selectPiece(square.piece)"
        ></div>
      </template>
      <template x-for="piece of game.pieces" :key="piece.id">
        <div
          class="piece"
          :data-color="piece.color"
          :data-type="piece.type"
          :data-active="game.activePieces.includes(piece)"
          :data-selected="piece === selectedPiece"
          :style="{ '--col': piece.x, '--row': piece.y }"
        ></div>
      </template>
    </div>
    <div class="info">
      <h1>Dropchess</h1>
      <p>
        After any <em>non-pawn</em> piece moves, the previous tile drops out of
        the board.
      </p>
      <p>Instead of capturing pieces you knock them backwards.</p>
      <p>The aim of the game is to knock the opponent's king off the board.</p>
      <p>There is no check, castling, or en-passant.</p>
    </div>
  </body>
  <script type="module" src="app.js" defer></script>
  <script src="https://unpkg.com/alpinejs" defer></script>
</html>
